#include <math.h>

// Define sign function
double sign(double x) {
    if (x > 0) return 1.0;
    if (x < 0) return -1.0;
    return 0.0;
}

void tau( double* tau_out, const double* parms, const double* q, const double* dq, const double* ddq )
{
  double x0 = sin(q[5]);
  double x1 = sin(q[3]);
  double x2 = sin(q[2]);
  double x3 = cos(q[2]);
  double x4 = cos(q[1]);
  double x5 = dq[0]*x4;
  double x6 = dq[1]*x2 + x3*x5;
  double x7 = -x6;
  double x8 = sin(q[1]);
  double x9 = -x8;
  double x10 = dq[0]*x9;
  double x11 = -x10;
  double x12 = dq[2] + x11;
  double x13 = cos(q[3]);
  double x14 = x1*x7 + x12*x13;
  double x15 = dq[4] + x14;
  double x16 = cos(q[5]);
  double x17 = sin(q[4]);
  double x18 = -x2;
  double x19 = dq[1]*x3 + x18*x5;
  double x20 = -x19;
  double x21 = dq[3] + x20;
  double x22 = -x21;
  double x23 = cos(q[4]);
  double x24 = x1*x12 + x13*x6;
  double x25 = x17*x22 + x23*x24;
  double x26 = -x25;
  double x27 = x0*x26 + x15*x16;
  double x28 = -x24;
  double x29 = x17*x28 + x22*x23;
  double x30 = -x29;
  double x31 = dq[5] + x30;
  double x32 = x0*x15 + x16*x25;
  double x33 = parms[72]*x32 + parms[74]*x27 + parms[75]*x31;
  double x34 = dq[1]*x10;
  double x35 = ddq[0]*x4 + x34;
  double x36 = ddq[1]*x3 + dq[2]*x7 - x2*x35;
  double x37 = -x36;
  double x38 = ddq[3] + x37;
  double x39 = -x38;
  double x40 = ddq[1]*x2 + dq[2]*x19 + x3*x35;
  double x41 = -ddq[0]*x8 - dq[1]*x5;
  double x42 = ddq[2] - x41;
  double x43 = dq[3]*x14 + x1*x42 + x13*x40;
  double x44 = dq[4]*x29 + x17*x39 + x23*x43;
  double x45 = -x40;
  double x46 = dq[3]*x28 + x1*x45 + x13*x42;
  double x47 = ddq[4] + x46;
  double x48 = dq[5]*x27 + x0*x47 + x16*x44;
  double x49 = -((x24)*(x24));
  double x50 = -((x21)*(x21));
  double x51 = x49 + x50;
  double x52 = x12*x6;
  double x53 = -9.81*x8;
  double x54 = -x53;
  double x55 = -0.32*((dq[1])*(dq[1])) - 0.32*((x5)*(x5)) + x54;
  double x56 = 0.077*x37 + 0.077*x52 + x55;
  double x57 = -((x12)*(x12));
  double x58 = -((x19)*(x19)) + x57;
  double x59 = 9.81*x4;
  double x60 = 0.32*ddq[1] - 0.32*x10*x5 + x59;
  double x61 = -0.32*x34 - 0.32*x35;
  double x62 = x2*x61 + x3*x60;
  double x63 = 0.077*x58 + x62;
  double x64 = -x1;
  double x65 = x13*x56 + x63*x64;
  double x66 = -0.26*x51 + x65;
  double x67 = x19*x6;
  double x68 = x42 + x67;
  double x69 = x18*x60 + x3*x61;
  double x70 = -x69;
  double x71 = -0.077*x68 + x70;
  double x72 = x14*x21;
  double x73 = x43 + x72;
  double x74 = x71 - 0.26*x73;
  double x75 = -x17;
  double x76 = x14*x24;
  double x77 = x39 + x76;
  double x78 = x1*x56 + x13*x63;
  double x79 = -0.26*x77 + x78;
  double x80 = x23*x79 + x74*x75;
  double x81 = -x80;
  double x82 = x0*x81 + x16*x66;
  double x83 = -x44;
  double x84 = -x32;
  double x85 = dq[5]*x84 + x0*x83 + x16*x47;
  double x86 = parms[71]*x32 + parms[73]*x27 + parms[74]*x31;
  double x87 = -x23;
  double x88 = x74*x87 + x75*x79;
  double x89 = -x88;
  double x90 = -x43;
  double x91 = dq[4]*x26 + x17*x90 + x23*x39;
  double x92 = -x91;
  double x93 = ddq[5] + x92;
  double x94 = parms[70]*x48 + parms[71]*x85 + parms[72]*x93 + parms[77]*x89 - parms[78]*x82 + x27*x33 - x31*x86;
  double x95 = x0*x66 + x16*x80;
  double x96 = parms[70]*x32 + parms[71]*x27 + parms[72]*x31;
  double x97 = parms[71]*x48 + parms[73]*x85 + parms[74]*x93 - parms[76]*x89 + parms[78]*x95 + x31*x96 + x33*x84;
  double x98 = parms[57]*x25 + parms[59]*x29 + parms[60]*x15;
  double x99 = parms[56]*x25 + parms[57]*x29 + parms[58]*x15;
  double x100 = parms[58]*x44 + parms[60]*x91 + parms[61]*x47 + parms[62]*x88 + parms[63]*x81 + x0*x94 + x16*x97 + x25*x98 + x30*x99;
  double x101 = parms[44]*x24 + parms[46]*x14 + parms[47]*x21;
  double x102 = parms[42]*x24 + parms[43]*x14 + parms[44]*x21;
  double x103 = parms[43]*x43 + parms[45]*x46 + parms[46]*x38 - parms[48]*x71 + parms[50]*x78 + x100 + x101*x28 + x102*x21;
  double x104 = parms[43]*x24 + parms[45]*x14 + parms[46]*x21;
  double x105 = parms[58]*x25 + parms[60]*x29 + parms[61]*x15;
  double x106 = -x0;
  double x107 = parms[56]*x44 + parms[57]*x91 + parms[58]*x47 + parms[63]*x66 + parms[64]*x89 + x105*x29 + x106*x97 - x15*x98 + x16*x94;
  double x108 = x31*x32;
  double x109 = -((x32)*(x32));
  double x110 = -((x27)*(x27));
  double x111 = x27*x31;
  double x112 = x15*x29;
  double x113 = x25*x29;
  double x114 = -((x25)*(x25));
  double x115 = -((x15)*(x15));
  double x116 = parms[62]*(x113 + x47) + parms[63]*(x114 + x115) + parms[64]*(x112 + x83) + parms[65]*x88 - parms[76]*(x108 - x85) - parms[77]*(x111 + x48) - parms[78]*(x109 + x110) - parms[79]*x89;
  double x117 = parms[72]*x48 + parms[74]*x85 + parms[75]*x93 + parms[76]*x82 - parms[77]*x95 - x27*x96 + x32*x86;
  double x118 = parms[57]*x44 + parms[59]*x91 + parms[60]*x47 - parms[62]*x66 + parms[64]*x80 + x105*x26 - x117 + x15*x99;
  double x119 = -((x31)*(x31));
  double x120 = x27*x32;
  double x121 = parms[76]*(x110 + x119) + parms[77]*(x120 - x93) + parms[78]*(x108 + x85) + parms[79]*x95;
  double x122 = parms[76]*(x120 + x93) + parms[77]*(x109 + x119) + parms[78]*(x111 - x48) + parms[79]*x82;
  double x123 = x15*x25;
  double x124 = -((x29)*(x29));
  double x125 = parms[62]*(x115 + x124) + parms[63]*(x113 - x47) + parms[64]*(x123 + x91) + parms[65]*x80 + x106*x122 + x121*x16;
  double x126 = parms[42]*x43 + parms[43]*x46 + parms[44]*x38 + parms[49]*x71 - parms[50]*x65 + x101*x14 + x104*x22 + x107*x23 + 0.26*x116*x23 + x118*x75 + 0.26*x125*x17;
  double x127 = parms[28]*x6 + parms[29]*x19 + parms[30]*x12;
  double x128 = parms[29]*x6 + parms[31]*x19 + parms[32]*x12;
  double x129 = -((x14)*(x14));
  double x130 = x21*x24;
  double x131 = parms[48]*(x130 - x46) + parms[49]*x73 + parms[50]*(x129 + x49) + parms[51]*x71 + x116*x87 + x125*x75;
  double x132 = parms[30]*x40 + parms[32]*x36 + parms[33]*x42 + parms[34]*x69 - parms[35]*x62 + x1*x126 + x103*x13 + x127*x20 + x128*x6 - 0.077*x131;
  double x133 = dq[1]*parms[16] + parms[14]*x5 + parms[15]*x10;
  double x134 = dq[1]*parms[19] + parms[16]*x5 + parms[18]*x10;
  double x135 = parms[30]*x6 + parms[32]*x19 + parms[33]*x12;
  double x136 = parms[28]*x40 + parms[29]*x36 + parms[30]*x42 + parms[35]*x55 + parms[36]*x70 + x103*x64 - x12*x128 + x126*x13 + x135*x19;
  double x137 = parms[48]*(x38 + x76) + parms[49]*x51 + parms[50]*(x72 + x90) + parms[51]*x65 + parms[62]*(x123 + x92) + parms[63]*(x112 + x44) + parms[64]*(x114 + x124) + parms[65]*x66 + x0*x121 + x122*x16;
  double x138 = x125*x23;
  double x139 = parms[48]*(x129 + x50) + parms[49]*x77 + parms[50]*(x130 + x46) + parms[51]*x78 + x116*x75 + x138;
  double x140 = parms[34]*x58 + parms[35]*(-x42 + x67) + parms[36]*(x36 + x52) + parms[37]*x62 + x13*x139 + x137*x64;
  double x141 = parms[34]*x68 + parms[35]*(x57 - ((x6)*(x6))) + parms[36]*(x12*x19 + x45) + parms[37]*x69 - x131;
  double x142 = parms[44]*x43 + parms[46]*x46 + parms[47]*x38 + parms[48]*x65 - parms[49]*x78 - x102*x14 + x104*x24 + x107*x75 - 0.26*x116*x17 + x118*x87 + 0.26*x138;
  double x143 = parms[29]*x40 + parms[31]*x36 + parms[32]*x42 - parms[34]*x55 + parms[36]*x62 - 0.077*x1*x139 + x12*x127 - 0.077*x13*x137 + x135*x7 - x142;
  double x144 = dq[1]*parms[18] + parms[15]*x5 + parms[17]*x10;
//
  tau_out[0] = ddq[0]*parms[10] + ddq[0]*parms[5] + dq[0]*parms[11] + parms[12]*sign(dq[0]) + parms[13] + x4*(ddq[1]*parms[16] - dq[1]*x144 + parms[14]*x35 + parms[15]*x41 + parms[22]*x54 + x10*x134 + x136*x3 - 0.32*x140*x2 - 0.32*x141*x3 + x143*x18) + x9*(ddq[1]*parms[18] + dq[1]*x133 + parms[15]*x35 + parms[17]*x41 + parms[22]*x59 - x132 - x134*x5);
  tau_out[1] = ddq[1]*parms[19] + ddq[1]*parms[24] + dq[1]*parms[25] + parms[16]*x35 + parms[18]*x41 + parms[20]*x53 - parms[21]*x59 + parms[26]*sign(dq[1]) + parms[27] + x11*x133 + x136*x2 + 0.32*x140*x3 - 0.32*x141*x2 + x143*x3 + x144*x5;
  tau_out[2] = ddq[2]*parms[38] + dq[2]*parms[39] + parms[40]*sign(dq[2]) + parms[41] + x132;
  tau_out[3] = ddq[3]*parms[52] + dq[3]*parms[53] + parms[54]*sign(dq[3]) + parms[55] + x142;
  tau_out[4] = ddq[4]*parms[66] + dq[4]*parms[67] + parms[68]*sign(dq[4]) + parms[69] + x100;
  tau_out[5] = ddq[5]*parms[80] + dq[5]*parms[81] + parms[82]*sign(dq[5]) + parms[83] + x117;
//
  return;
}